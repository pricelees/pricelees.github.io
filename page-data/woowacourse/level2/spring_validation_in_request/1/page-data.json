{"componentChunkName":"component---src-templates-blog-template-js","path":"/woowacourse/level2/spring_validation_in_request/1/","result":{"data":{"cur":{"id":"6ae84898-7e4a-5330-a15f-bf43aadb3174","html":"<h2 id=\"배경\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EA%B2%BD\" aria-label=\"배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배경</h2>\n<p><a href=\"https://github.com/pricelees/spring-roomescape-member/tree/step2\">우아한테크코스의 두 번째 스프링 미션</a>을 통해 처음으로 스프링의 예외 처리를 경험하게 되었습니다.</p>\n<p>미션의 요구 사항은 <strong>예약, 테마, 시간 생성시 발생하는 예외를 적절하게 처리</strong>하는 것이었는데요, <code class=\"language-text\">지나간 날짜에 대한 예약은 불가능하다</code> 와 <code class=\"language-text\">입력된 ID에 대한 값이 DB에 없는</code> 것과 같은 예외 처리는 크게 어렵지 않았으나 입력에서의\n예외, 즉 <strong>입력되지 않은 값 등 값 자체가 잘못되었을 때</strong>에 대한 처리가 가장 어려웠습니다.</p>\n<p>가장 많이 헤맸던 이유는 <strong>요청 상황마다 발생하는 예외 타입이 달랐기 때문</strong>인데요, 이번 글에서는 해당 문제와 이 문제를 해결해가는 과정에 대해 기록해보려 합니다.</p>\n<p><U><strong>주의</strong></U></p>\n<p>스프링을 이번에 처음 사용하게 되어, 내용이 매우 부실할 수 있습니다. 이 글은 지식을 전달하는 글이 아닌, 개인의 시행착오 과정을 기록하는 글임을 감안해주시면 감사하겠습니다.🙇</p>\n<br/>\n<h2 id=\"api-구성\" style=\"position:relative;\"><a href=\"#api-%EA%B5%AC%EC%84%B1\" aria-label=\"api 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API 구성</h2>\n<h3 id=\"api---관리자가-직접-예약을-추가\" style=\"position:relative;\"><a href=\"#api---%EA%B4%80%EB%A6%AC%EC%9E%90%EA%B0%80-%EC%A7%81%EC%A0%91-%EC%98%88%EC%95%BD%EC%9D%84-%EC%B6%94%EA%B0%80\" aria-label=\"api   관리자가 직접 예약을 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API - 관리자가 직접 예약을 추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST /reservations HTTP/<span class=\"token number\">1.1</span>\ncontent-type<span class=\"token operator\">:</span> application/json\n\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"date\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"2024-05-10\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"memberId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"themeId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"timeId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"1\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>관리자가 직접 예약을 추가할 땐, 예약 페이지에서 이미 등록된 회원, 테마, 시간과 날짜를 선택합니다. 이때 <strong>회원, 테마, 시간은</strong> <strong>DB에 저장된 ID값으로 요청</strong>됩니다. (DB에 회원1의 ID가 1로\n저장되어있다면, 관리자는 회원1을 선택하는데 요청은 이 회원의 ID인 1로 보내집니다)</p>\n<br/>\n<h3 id=\"api---테마-추가\" style=\"position:relative;\"><a href=\"#api---%ED%85%8C%EB%A7%88-%EC%B6%94%EA%B0%80\" aria-label=\"api   테마 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API - 테마 추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST /themes HTTP/<span class=\"token number\">1.1</span>\ncontent-type<span class=\"token operator\">:</span> application/json\n\n<span class=\"token punctuation\">{</span>\n   <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"테마 설명\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"테마 이름\"</span><span class=\"token punctuation\">,</span>\n   <span class=\"token property\">\"thumbnail\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"테마 썸네일 사진 URL\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>테마를 추가할땐, 이름, 설명, 썸네일 주소를 입력받습니다. 이 값은 모두 문자열입니다.</p>\n<br/>\n<h3 id=\"api---시간-추가\" style=\"position:relative;\"><a href=\"#api---%EC%8B%9C%EA%B0%84-%EC%B6%94%EA%B0%80\" aria-label=\"api   시간 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API - 시간 추가</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\">POST /times HTTP/<span class=\"token number\">1.1</span>\ncontent-type<span class=\"token operator\">:</span> application/json\n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"startAt\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"HH:mm\"</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>시간을 추가할 땐, HH:mm 형태의 시간값을 입력받습니다.</p>\n<br/>\n<h2 id=\"문제-상황\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\" aria-label=\"문제 상황 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제 상황</h2>\n<h3 id=\"테마와-시간을-추가할-때-값을-입력하지-않는다면--methodargumentnotvalidexception\" style=\"position:relative;\"><a href=\"#%ED%85%8C%EB%A7%88%EC%99%80-%EC%8B%9C%EA%B0%84%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%A0-%EB%95%8C-%EA%B0%92%EC%9D%84-%EC%9E%85%EB%A0%A5%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4%EB%A9%B4--methodargumentnotvalidexception\" aria-label=\"테마와 시간을 추가할 때 값을 입력하지 않는다면  methodargumentnotvalidexception permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>테마와 시간을 추가할 때 값을 입력하지 않는다면?- MethodArgumentNotValidException</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">ThemeCreateRequest</span><span class=\"token punctuation\">(</span>\n        <span class=\"token annotation punctuation\">@NotBlank</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"테마 이름을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotBlank</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"테마 설명을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token class-name\">String</span> description<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotBlank</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"썸네일 주소를 입력해 주세요.\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token class-name\">String</span> thumbnail\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위의 코드는, 테마를 추가할 때 사용하는 요청 DTO의 코드입니다. 위의 테마 추가 API 명세에 맞게 구성되어 있으며, <code class=\"language-text\">@NotBlank</code> 를 통해 빈 값을 입력받지 않도록 구성하였습니다.</p>\n<blockquote>\n<p><code class=\"language-text\">@NotBlank</code> 어노테이션은 해당 필드가 null이거나 빈 문자열(\"\")이 아닌지를 확인합니다.</p>\n</blockquote>\n<br/>\n<p><strong>만약 값을 입력하지 않으면</strong> 어떤 형태로 요청이 될까요? 테마를 추가할 때 이 세 가지의 값을 입력하지 않으면 요청 JSON은 다음과 같은 형태로 전송됩니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>themes <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\ncontent<span class=\"token operator\">-</span>type<span class=\"token operator\">:</span>application<span class=\"token operator\">/</span>json \n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"thumbnail\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>빈 값이 입력되었을 때 발생되는 에러의 원인을 확인해보기 위해, 아래와 같이 간단한 ExceptionHandler를 만들어 스택 트레이스를 출력해 보겠습니다 ㅎㅎ</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token class-name\">Exception</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p>스택 트레이스를 통해 발생되는 예외를 확인해보니, 다음과 같이 <code class=\"language-text\">MethodArgumentNotValidException</code>이 발생하는 것을 확인할 수 있었습니다. <strong>시간의 경우</strong>도 <code class=\"language-text\">startAt</code> 값이 빈\n문자열로 입력되어 같은 타입의 예외가 발생합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span></span>MethodArgumentNotValidException</span><span class=\"token operator\">:</span>\n<span class=\"token class-name\">Validation</span> failed <span class=\"token keyword\">for</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<br/>\n<h3 id=\"️-예약을-추가할-때-값을-입력하지-않는다면---invalidformatexception\" style=\"position:relative;\"><a href=\"#%EF%B8%8F-%EC%98%88%EC%95%BD%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%A0-%EB%95%8C-%EA%B0%92%EC%9D%84-%EC%9E%85%EB%A0%A5%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4%EB%A9%B4---invalidformatexception\" aria-label=\"️ 예약을 추가할 때 값을 입력하지 않는다면   invalidformatexception permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>⭐️ 예약을 추가할 때 값을 입력하지 않는다면? - InvalidFormatException</h3>\n<p>테마와 시간을 추가할 때, 값을 입력하지 않으면 <code class=\"language-text\">빈 문자열</code> 형태로 요청되는 것을 확인하였기에, <strong>예약을 추가할 때 역시 값을 입력하지 않으면 빈 값으로 처리될 것이라고 생각</strong>했습니다. 그래서 예약 페이지에서\n모든 값을 선택하지 않고 요청을 보냈는데…</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token constant\">POST</span> <span class=\"token operator\">/</span>reservations <span class=\"token constant\">HTTP</span><span class=\"token operator\">/</span><span class=\"token number\">1.1</span>\ncontent<span class=\"token operator\">-</span>type<span class=\"token operator\">:</span>application<span class=\"token operator\">/</span>json \n\n<span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"date\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"memberId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"멤버 선택\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"themeId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"테마 선택\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"timeId\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"시간 선택\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>위와 같이 <U><strong>날짜는 빈 값으로 입력되었으나 회원, 테마, 시간의 경우 각각 “멤버 선택”, “테마 선택”, “시간 선택”이라는 값으로 요청이 되고 있었습니다.</strong></U></p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">AdminReservationCreateRequest</span><span class=\"token punctuation\">(</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"날짜를 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDate</span> date<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"시간을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> timeId<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"테마를 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> themeId<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"회원을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> memberId\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>그래서 이 Request DTO 코드에서 date값을 제외하고 <code class=\"language-text\">@NotNull</code> 이 작동하지 않는 상황이었습니다. (date의 경우 값을 입력하지 않으면 빈 문자열로\n요청되어 <code class=\"language-text\">MethodArgumentNotValidException</code>이 발생합니다.)</p>\n<br/>\n<p>마찬가지로, 이전에 작성한 ExceptionHandler를 이용하여 스택 트레이스를 출력해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span>converter<span class=\"token punctuation\">.</span></span>HttpMessageNotReadableException</span><span class=\"token operator\">:</span> <span class=\"token constant\">JSON</span> parse error<span class=\"token operator\">:</span> <span class=\"token class-name\">Cannot</span> deserialize value of type `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>` from <span class=\"token class-name\">String</span> <span class=\"token string\">\"멤버 선택\"</span><span class=\"token operator\">:</span> not a valid `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>`value\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token class-name\">Caused</span> by<span class=\"token operator\">:</span><span class=\"token class-name\"><span class=\"token namespace\">com<span class=\"token punctuation\">.</span>fasterxml<span class=\"token punctuation\">.</span>jackson<span class=\"token punctuation\">.</span>databind<span class=\"token punctuation\">.</span>exc<span class=\"token punctuation\">.</span></span>InvalidFormatException</span><span class=\"token operator\">:</span> <span class=\"token class-name\">Cannot</span> deserialize value of type `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>` from <span class=\"token class-name\">String</span> <span class=\"token string\">\"멤버 선택\"</span><span class=\"token operator\">:</span> not a valid `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>`value\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span></code></pre></div>\n<p>출력된 결과를 보고 아래의 두 가지를 유추할 수 있었습니다.</p>\n<ol>\n<li><code class=\"language-text\">“멤버 선택”</code>이라는 <strong>문자열을 Long 타입으로 변환할 수 없기에</strong> <code class=\"language-text\">InvalidFormatException</code>이 발생한다.</li>\n<li><code class=\"language-text\">InvalidFormatException</code>이 발생해도, 발생되는 예외 타입은 <code class=\"language-text\">HttpMessageNotReadableException</code> 이다.</li>\n</ol>\n<br/>\n<p><strong>(번외)</strong></p>\n<p>실제로 스택 트레이스를 보면 <code class=\"language-text\">AbstractJackson2HttpMessageConverter.readJavaType</code> 에서 예외가 발생했다고 하는데, 이 소스코드를 보면 <strong>try - catch</strong>로 특정 예외가\n발생하면 <code class=\"language-text\">HttpMessageNotReadableException</code>을 던지는 것을 확인할 수 있습니다.</p>\n<br/>\n<h3 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h3>\n<p>결론적으로 현재 상황에서는 <code class=\"language-text\">MethodArgumentNotValidException</code> 과 <code class=\"language-text\">InvalidFormatException</code> 으로 예외 처리를 나눌 수 있겠다고 판단했습니다.</p>\n<ul>\n<li><strong>MethodArgumentNotValidException</strong> 은 날짜, 시간, 테마 이름, 테마 설명, 테마 썸네일</li>\n<li><strong>InvalidFormatException(HttpMessageNotReadableException)</strong> 은 회원 ID, 테마 ID, 시간 ID</li>\n</ul>\n<br/>\n<h2 id=\"예외-응답-dto\" style=\"position:relative;\"><a href=\"#%EC%98%88%EC%99%B8-%EC%9D%91%EB%8B%B5-dto\" aria-label=\"예외 응답 dto permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>예외 응답 DTO</h2>\n<p>본격적으로 예외 처리를 해보기 전에, 다음과 같은 간단한 <strong>예외 응답용 DTO</strong>를 구성해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">ErrorResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> url<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> method<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 DTO는 <strong>요청 url, 요청 HTTP 메서드, 예외 메시지</strong>로 구성하였습니다.(<strong>이번 단계에서는 실제 응답 값으로 디버깅을 했기 때문에</strong> 위와 같이 구성했고, 이후에 로깅을 시도함에 따라 예외 응답\n객체의 구성을 바꾸게 되었습니다 ㅎㅎ)</p>\n<br/>\n<h2 id=\"methodargumentnotvalidexception-처리\" style=\"position:relative;\"><a href=\"#methodargumentnotvalidexception-%EC%B2%98%EB%A6%AC\" aria-label=\"methodargumentnotvalidexception 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MethodArgumentNotValidException 처리</h2>\n<p>우선, <code class=\"language-text\">@Valid</code>  어노테이션 검증으로 인해 발생하는 <code class=\"language-text\">MethodArgumentNotValidException</code> 을 먼저 처리하고자 했습니다. 방법을 모르니 열심히 구글링한\n결과 <a href=\"https://www.baeldung.com/global-error-handler-in-a-spring-rest-api#1-handling-the-exceptions\">빛과 같은 baeldung의 글(빛덩..)</a>\n을 찾게 되었고 이곳에 작성된 방법을 참고하여 진행하였습니다.</p>\n<p>예외 메시지를 작성하기에 앞서, 만약 <strong>여러 개의 값에서 예외가 발생하면</strong> 어떻게 할까요? <strong>모든 예외 메시지를 합쳐서 응답</strong>할수도 있고, <strong>그 중 하나의 값에 대한 메시지만 응답</strong>할 수도 있습니다. 당연히 처음 하는 만큼 두\n방법 모두를 시도하였습니다.</p>\n<br/>\n<h3 id=\"1-여러-값에서-예외가-발생되도-하나만-출력하자\" style=\"position:relative;\"><a href=\"#1-%EC%97%AC%EB%9F%AC-%EA%B0%92%EC%97%90%EC%84%9C-%EC%98%88%EC%99%B8%EA%B0%80-%EB%B0%9C%EC%83%9D%EB%90%98%EB%8F%84-%ED%95%98%EB%82%98%EB%A7%8C-%EC%B6%9C%EB%A0%A5%ED%95%98%EC%9E%90\" aria-label=\"1 여러 값에서 예외가 발생되도 하나만 출력하자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 여러 값에서 예외가 발생되도 하나만 출력하자</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodArgumentNotValidException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleMethodArgumentNotValidException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span>\n                                                           <span class=\"token class-name\">MethodArgumentNotValidException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> errorMessage <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getBindingResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFieldError</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getDefaultMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorResponse</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>                </code></pre></div>\n<p>Baeldung의 글에서는 <code class=\"language-text\">getFieldErrors()</code> 를 이용하여 모든 예외를 리스트로 받지만, <code class=\"language-text\">getFieldError()</code> 라는 하나의 예외만 받아오는 메서드가 있었고 이를 활용하였습니다.</p>\n<p>하지만, 이 방법은 좋은 방법이 아니었습니다. 만약 테마에서 이름, 설명, 썸네일 모두를 입력하지 않게 되면 <strong>어떨 때는 “설명을 입력해 주세요” 가 반환되고, 어떨 때는 “썸네일을 입력해 주세요”가 반환되는 등\n매번 다른 결과가 나왔기에</strong> 특정 상황에 대한 정확한 예외 메시지를 예측할 수 없는 문제가 있었습니다.</p>\n<ul>\n<li>테스트를 할 때, 단순히 HTTP 코드로 확인하는 경우 문제가 없겠지만 구체적인 예외 메시지에 대한 테스트는 불가능해지게 됩니다.</li>\n</ul>\n<br/>\n<h3 id=\"2-여러-값에서-예외가-발생하면-모든-예외-메시지를-합쳐서-출력하자\" style=\"position:relative;\"><a href=\"#2-%EC%97%AC%EB%9F%AC-%EA%B0%92%EC%97%90%EC%84%9C-%EC%98%88%EC%99%B8%EA%B0%80-%EB%B0%9C%EC%83%9D%ED%95%98%EB%A9%B4-%EB%AA%A8%EB%93%A0-%EC%98%88%EC%99%B8-%EB%A9%94%EC%8B%9C%EC%A7%80%EB%A5%BC-%ED%95%A9%EC%B3%90%EC%84%9C-%EC%B6%9C%EB%A0%A5%ED%95%98%EC%9E%90\" aria-label=\"2 여러 값에서 예외가 발생하면 모든 예외 메시지를 합쳐서 출력하자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 여러 값에서 예외가 발생하면, 모든 예외 메시지를 합쳐서 출력하자.</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MethodArgumentNotValidException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleMethodArgumentNotValidException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span>\n                                                           <span class=\"token class-name\">MethodArgumentNotValidException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> errorMessage <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getBindingResult</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFieldErrors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">FieldError</span><span class=\"token operator\">::</span><span class=\"token function\">getDefaultMessage</span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">collect</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Collectors</span><span class=\"token punctuation\">.</span><span class=\"token function\">joining</span><span class=\"token punctuation\">(</span><span class=\"token string\">\", \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorResponse</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> errorMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>        </code></pre></div>\n<p>Baeldung에서는 For문을 이용하여 처리하지만, Stream을 이용하여 모든 예외 메시지를 <code class=\"language-text\">“, “</code>로 구분하여 합치는 방식으로 구현하였습니다.</p>\n<br/>\n<h3 id=\"결과\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"결과 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결과</h3>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token comment\">// 모든 값을 입력하지 않는 경우</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/themes\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"테마 설명을 입력해 주세요, 썸네일 주소를 입력해 주세요, 테마 이름을 입력해 주세요\"</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// 테마 설명만 입력한 경우</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/themes\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"method\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"message\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"썸네일 주소를 입력해 주세요, 테마 이름을 입력해 주세요\"</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>지금은 값을 입력하지 않은(빈 값인) 경우만 고려하지만, <code class=\"language-text\">@Valid</code> 어노테이션으로 지정한 모든 예외는 이 방법으로 처리할 수 있었습니다.</p>\n<br/>\n<h2 id=\"invalidformatexception-처리\" style=\"position:relative;\"><a href=\"#invalidformatexception-%EC%B2%98%EB%A6%AC\" aria-label=\"invalidformatexception 처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>InvalidFormatException 처리</h2>\n<h3 id=\"들어가기-전에\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90\" aria-label=\"들어가기 전에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가기 전에..</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">INTERNAL_SERVER_ERROR</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorResponse</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>ControllerAdvice</strong>에는 핸들러가 없는 예외 처리를 위해, 위와 같은 Exception 타입을 처리하는 핸들러가 정의되어 있습니다.</p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">InvalidFormatException</span> e<span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleInvalidFormatException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">InvalidFormatException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 상황에서, 위와 같이 InvalidFormatException 타입을 처리하도록 구현하면, 예외 발생시 Exception 타입 핸들러가 예외를 처리하게 됩니다.</p>\n<ul>\n<li><strong>실제 발생한 예외는 InvalidFormatException 이지만, Jackson은 HttpMessageNotReadableException 타입으로 예외를 발생시키기 때문입니다!</strong></li>\n</ul>\n<p>따라서, 이후의 과정에서는 InvalidFormatException이 아닌 <code class=\"language-text\">HttpMessageNotReadableException</code>으로 해당 예외를 처리하겠습니다.</p>\n<br/>\n<h3 id=\"우선-다-뽑아보겠습니다\" style=\"position:relative;\"><a href=\"#%EC%9A%B0%EC%84%A0-%EB%8B%A4-%EB%BD%91%EC%95%84%EB%B3%B4%EA%B2%A0%EC%8A%B5%EB%8B%88%EB%8B%A4\" aria-label=\"우선 다 뽑아보겠습니다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>우선 다 뽑아보겠습니다.</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpMessageNotReadableException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleHttpMessageNotReadableException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span>\n                                                           <span class=\"token class-name\">HttpMessageNotReadableException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"e.getMessage() = \"</span> <span class=\"token operator\">+</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>글이 길어 다시 간략하게 작성하자면, HttpMessageNotReadableException은 <strong>관리자가 예약을 추가할 때 시간, 테마, 회원을 입력하지 않는 경우에 발생</strong>합니다. 이 예외 타입은\n이전처럼 <code class=\"language-text\">getBindingResult()</code> 와 같은 기능도 없기에.. 무작정 가능한 모든 것을 출력해 보았습니다.. 라고 하지만 사실 <code class=\"language-text\">getMessage()</code> 밖에 없더라구요 ㅎㅎ..</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span> parse error<span class=\"token operator\">:</span> <span class=\"token class-name\">Cannot</span> deserialize value of type `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>` from <span class=\"token class-name\">String</span> <span class=\"token string\">\"테마 선택\"</span><span class=\"token operator\">:</span> not a valid `<span class=\"token class-name\"><span class=\"token namespace\">java<span class=\"token punctuation\">.</span>lang<span class=\"token punctuation\">.</span></span>Long</span>`value</code></pre></div>\n<p>출력 결과는 위와 같이 되는데, 앞 부분은 크게 의미 없고 뒤에 있는 <strong>“테마 선택”</strong> 부분은 활용할 수 있을 것 같습니다.</p>\n<br/>\n<h3 id=\"1차-시도\" style=\"position:relative;\"><a href=\"#1%EC%B0%A8-%EC%8B%9C%EB%8F%84\" aria-label=\"1차 시도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1차 시도</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@ExceptionHandler</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpMessageNotReadableException</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token annotation punctuation\">@ResponseStatus</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span><span class=\"token constant\">BAD_REQUEST</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ErrorResponse</span> <span class=\"token function\">handleHttpMessageNotReadableException</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span>\n                                                           <span class=\"token class-name\">HttpMessageNotReadableException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> message <span class=\"token operator\">=</span> e<span class=\"token punctuation\">.</span><span class=\"token function\">getMessage</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">String</span> errorField <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"멤버\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        errorField <span class=\"token operator\">=</span> <span class=\"token string\">\"멤버\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"시간\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        errorField <span class=\"token operator\">=</span> <span class=\"token string\">\"시간\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">.</span><span class=\"token function\">contains</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"테마\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        errorField <span class=\"token operator\">=</span> <span class=\"token string\">\"테마\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token class-name\">String</span> responseMessage <span class=\"token operator\">=</span> errorField <span class=\"token operator\">+</span> <span class=\"token string\">\"을(를) 입력해 주세요.\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ErrorResponse</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getRequestURI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getMethod</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> responseMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>단순하게, 이전에 발생한 예외 메시지를 참고하여 String의 contains를 이용하여 처리하는 방식입니다.</p>\n<br/>\n<h3 id=\"문제점\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"문제점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제점</h3>\n<p>일단 처리 자체는 되었지만, 문제점이 정~말 많은 방식이라고 느껴졌습니다.</p>\n<ol>\n<li>지금의 예외 핸들링은, 테마, 시간, 멤버를 선택하지 않았을 때 기본 입력값인 <code class=\"language-text\">“테마 선택”</code> 등에 의존합니다. <strong>즉 클라이언트 코드에 완전히 의존하는 구조입니다.</strong></li>\n<li>멤버, 시간, 테마 중 2개 이상의 값이 입력되지 않아도 하나의 값만 표시됩니다. 즉 <strong>입력되지 않은 모든 값을 예외 메시지에 담을 수 없습니다.</strong>\n<ul>\n<li>추가적으로, 날짜를 입력하지 않았을 때 발생하는 MethodArgumentNotValidException와 같이 묶어서 처리할 수도 없습니다!</li>\n</ul>\n</li>\n</ol>\n<br/>\n<h2 id=\"다음-편에-계속됩니다\" style=\"position:relative;\"><a href=\"#%EB%8B%A4%EC%9D%8C-%ED%8E%B8%EC%97%90-%EA%B3%84%EC%86%8D%EB%90%A9%EB%8B%88%EB%8B%A4\" aria-label=\"다음 편에 계속됩니다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>다음 편에 계속됩니다..</h2>\n<p>여러 방법을 찾아보던 도중 <code class=\"language-text\">Custom Deserializer</code>를 이용하여 이 문제들을 해결할 수 있었는데요, <code class=\"language-text\">Custom Deserializer</code>와 <code class=\"language-text\">JsonNode</code>와 같은 내용에 대한 고민 과정까지\n작성하기엔 글이 너무 길어지겠다는 생각에 이 부분은 다음 편에 별도로 작성하겠습니다 🙇</p>\n<p>여기까지 읽어주셔서 감사합니다. 즐거운 하루 보내세요😄</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B0%B0%EA%B2%BD\">배경</a></p>\n</li>\n<li>\n<p><a href=\"#api-%EA%B5%AC%EC%84%B1\">API 구성</a></p>\n<ul>\n<li><a href=\"#api---%EA%B4%80%EB%A6%AC%EC%9E%90%EA%B0%80-%EC%A7%81%EC%A0%91-%EC%98%88%EC%95%BD%EC%9D%84-%EC%B6%94%EA%B0%80\">API - 관리자가 직접 예약을 추가</a></li>\n<li><a href=\"#api---%ED%85%8C%EB%A7%88-%EC%B6%94%EA%B0%80\">API - 테마 추가</a></li>\n<li><a href=\"#api---%EC%8B%9C%EA%B0%84-%EC%B6%94%EA%B0%80\">API - 시간 추가</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%AC%B8%EC%A0%9C-%EC%83%81%ED%99%A9\">문제 상황</a></p>\n<ul>\n<li><a href=\"#%ED%85%8C%EB%A7%88%EC%99%80-%EC%8B%9C%EA%B0%84%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%A0-%EB%95%8C-%EA%B0%92%EC%9D%84-%EC%9E%85%EB%A0%A5%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4%EB%A9%B4--methodargumentnotvalidexception\">테마와 시간을 추가할 때 값을 입력하지 않는다면?- MethodArgumentNotValidException</a></li>\n<li><a href=\"#%EF%B8%8F-%EC%98%88%EC%95%BD%EC%9D%84-%EC%B6%94%EA%B0%80%ED%95%A0-%EB%95%8C-%EA%B0%92%EC%9D%84-%EC%9E%85%EB%A0%A5%ED%95%98%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4%EB%A9%B4---invalidformatexception\">⭐️ 예약을 추가할 때 값을 입력하지 않는다면? - InvalidFormatException</a></li>\n<li><a href=\"#%EC%9A%94%EC%95%BD\">요약</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%98%88%EC%99%B8-%EC%9D%91%EB%8B%B5-dto\">예외 응답 DTO</a></p>\n</li>\n<li>\n<p><a href=\"#methodargumentnotvalidexception-%EC%B2%98%EB%A6%AC\">MethodArgumentNotValidException 처리</a></p>\n<ul>\n<li><a href=\"#1-%EC%97%AC%EB%9F%AC-%EA%B0%92%EC%97%90%EC%84%9C-%EC%98%88%EC%99%B8%EA%B0%80-%EB%B0%9C%EC%83%9D%EB%90%98%EB%8F%84-%ED%95%98%EB%82%98%EB%A7%8C-%EC%B6%9C%EB%A0%A5%ED%95%98%EC%9E%90\">1. 여러 값에서 예외가 발생되도 하나만 출력하자</a></li>\n<li><a href=\"#2-%EC%97%AC%EB%9F%AC-%EA%B0%92%EC%97%90%EC%84%9C-%EC%98%88%EC%99%B8%EA%B0%80-%EB%B0%9C%EC%83%9D%ED%95%98%EB%A9%B4-%EB%AA%A8%EB%93%A0-%EC%98%88%EC%99%B8-%EB%A9%94%EC%8B%9C%EC%A7%80%EB%A5%BC-%ED%95%A9%EC%B3%90%EC%84%9C-%EC%B6%9C%EB%A0%A5%ED%95%98%EC%9E%90\">2. 여러 값에서 예외가 발생하면, 모든 예외 메시지를 합쳐서 출력하자.</a></li>\n<li><a href=\"#%EA%B2%B0%EA%B3%BC\">결과</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#invalidformatexception-%EC%B2%98%EB%A6%AC\">InvalidFormatException 처리</a></p>\n<ul>\n<li><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90\">들어가기 전에..</a></li>\n<li><a href=\"#%EC%9A%B0%EC%84%A0-%EB%8B%A4-%EB%BD%91%EC%95%84%EB%B3%B4%EA%B2%A0%EC%8A%B5%EB%8B%88%EB%8B%A4\">우선 다 뽑아보겠습니다.</a></li>\n<li><a href=\"#1%EC%B0%A8-%EC%8B%9C%EB%8F%84\">1차 시도</a></li>\n<li><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\">문제점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%8B%A4%EC%9D%8C-%ED%8E%B8%EC%97%90-%EA%B3%84%EC%86%8D%EB%90%A9%EB%8B%88%EB%8B%A4\">다음 편에 계속됩니다..</a></p>\n</li>\n</ul>\n</div>","excerpt":"배경 우아한테크코스의 두 번째 스프링 미션을 통해 처음으로 스프링의 예외 처리를 경험하게 되었습니다. 미션의 요구 사항은 예약, 테마, 시간 생성시 발생하는 예외를 적절하게 처리하는 것이었는데요,  와  것과 같은 예외 처리는 크게 어렵지 않았으나 입력에서의\n예외, 즉 입력되지 않은 값 등 값 자체가 잘못되었을 때에 대한 처리가 가장 어려웠습니다. 가장 많이 헤맸던 이유는 요청 상황마다 발생하는 예외 타입이 달랐기 때문인데요, 이번 글에서는 해당 문제와 이 문제를 해결해가는 과정에 대해 기록해보려 합니다. 주의 스프링을 이번에 처음 사용하게 되어, 내용이 매우 부실할 수 있습니다. 이 글은 지식을 전달하는 글이 아닌, 개인의 시행착오 과정을 기록하는 글임을 감안해주시면 감사하겠습니다.🙇 API 구성 API - 관리자가 직접 예약을 추가 관리자가 직접 예약을 추가할 땐, 예약 페이지에서 이미 등록된 회원, 테마, 시간과 날짜를 선택합니다. 이때 회원, 테마, 시간은 DB에 저장된 I…","frontmatter":{"date":"June 18, 2024","title":"스프링 입력에서의 예외 처리 여정 1 - 문제 인식 및 일부 해결","categories":"level2 Spring Exception","author":"이상진","emoji":"🌱"},"fields":{"slug":"/woowacourse/level2/spring_validation_in_request/1/"}},"next":{"id":"5cc77947-5c31-5f0b-919a-e56bf69c1c93","html":"<h2 id=\"배경\" style=\"position:relative;\"><a href=\"#%EB%B0%B0%EA%B2%BD\" aria-label=\"배경 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>배경</h2>\n<p><a href=\"https://github.com/pricelees/spring-roomescape-admin/tree/step2\">우아한테크코스의 첫 스프링 미션</a>을 진행하며, 처음으로 <strong>레이어드 아키텍쳐</strong>를 적용해보는\n경험을 하게 되었습니다.</p>\n<p>Controller에서 <strong>JdbcTemplate</strong>을 사용하여 DB 처리를 하는 기존 코드에 Service - Repository 계층을 추가하는 과정에서 자연스레 들었던 고민은 <strong>도메인과 DTO의 처리를 어떻게\n해야할지</strong>였고, 이때 가졌던 생각의 흐름을 정리해보고자 합니다.</p>\n<p>아래의 예시는 <strong>예약을 추가(저장) 하는 기능</strong>을 바탕으로 작성하였습니다😄</p>\n<br/>\n<h2 id=\"개요\" style=\"position:relative;\"><a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>개요</h2>\n<h3 id=\"api의-구성\" style=\"position:relative;\"><a href=\"#api%EC%9D%98-%EA%B5%AC%EC%84%B1\" aria-label=\"api의 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>API의 구성</h3>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">POST /reservations HTTP/1.1\ncontent-type: application/json\n\n{\n  \"date\": \"2024-04-20\",\n  \"name\": \"상돌\",\n  \"timeId\": 1\n}</code></pre></div>\n<p>예약을 추가할 때는 <code class=\"language-text\">이름, 날짜, 시간 ID값</code> 을 JSON 형태로 요청합니다. 예약 시간은 별도의 데이터베이스 테이블에 저장을 해둔 뒤, 시간의 ID값을 이용하여 조회합니다.</p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">HTTP/1.1 200\nContent-Type: application/json\n\n{\n  \"id\": 1,\n  \"name\": \"상돌\",\n  \"date\": \"2024-04-20\",\n  \"time\" : {\n    \"id\": 1,\n    \"startAt\" : \"10:00\"\n  }\n}</code></pre></div>\n<p>요청이 들어오면 <strong>ID값은 자동으로 채운 뒤</strong>(AUTO_INCREMENT), 입력된 시간 ID에 해당되는 예약 시간까지 불러와서 저장된 예약 내역을 응답하는 구조입니다.</p>\n<br/>\n<h3 id=\"도메인\" style=\"position:relative;\"><a href=\"#%EB%8F%84%EB%A9%94%EC%9D%B8\" aria-label=\"도메인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>도메인</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReservationTime</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> startAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 생성자 및 Getter..</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Reservation</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> date<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReservationTime</span> time<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 생성자 및 Getter..</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>여기서 날짜와 시간은 각각 LocalDate와 LocalTime을 사용할 수 있으나, 이번 단계에선 고려하지 않았습니다😄</p>\n<br/>\n<h3 id=\"요청-dto\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%B2%AD-dto\" aria-label=\"요청 dto permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요청 DTO</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">ReservationRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> date<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Long</span> timeId<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>요청 DTO는 API 명세에 따라 이름, 날짜, 시간 ID값으로 구성되어 있습니다.</li>\n</ul>\n<br/>\n<h3 id=\"응답-dto\" style=\"position:relative;\"><a href=\"#%EC%9D%91%EB%8B%B5-dto\" aria-label=\"응답 dto permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>응답 DTO</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">TimeResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> startAt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">TimeResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReservationTime</span> reservationTime<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>reservationTime<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservationTime<span class=\"token punctuation\">.</span><span class=\"token function\">getStartAt</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>예약 시간에 대한 응답 DTO입니다. ID와 시간으로 이루어져 있습니다.</li>\n</ul>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">ReservationResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> name<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> date<span class=\"token punctuation\">,</span> <span class=\"token class-name\">TimeResponse</span> time<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationResponse</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Reservation</span> reservation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span>reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n                <span class=\"token keyword\">new</span> <span class=\"token class-name\">TimeResponse</span><span class=\"token punctuation\">(</span>reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>예약에 대한 응답 DTO입니다. API 명세와 동일하게 ID, 이름, 날짜, 시간으로 구성되어 있습니다.</li>\n</ul>\n<br/>\n<h2 id=\"첫-번째-시도\" style=\"position:relative;\"><a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\" aria-label=\"첫 번째 시도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>첫 번째 시도</h2>\n<h3 id=\"구현-방법\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95\" aria-label=\"구현 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 방법</h3>\n<p>DTO 처리와 관련하여 열심히 구글링을 해본 결과, 크게 다음의 두 가지 의견으로 나뉘는 것을 확인하였습니다.</p>\n<ol>\n<li>\n<p><strong>Controller에서 요청 DTO를 도메인으로 변환</strong>하고 Service에 전달한다.</p>\n</li>\n<li>\n<p><strong>Controller에서 요청 DTO를 Service로 전달하고, Service에서 도메인으로 변환</strong>한 뒤 Repository로 전달한다.</p>\n</li>\n</ol>\n<p>저는 아래의 <strong>(지극히 주관적인)이유</strong>로 <strong>1번 방법</strong>을 선택하였습니다.</p>\n<ol>\n<li>\n<p>DTO는 도메인에 비해 변경 가능성이 크다.</p>\n</li>\n<li>\n<p>서비스에서 DTO를 처리하면, DTO가 변하면 서비스의 로직도 수정해야 한다.</p>\n</li>\n<li>\n<p>이전 레벨에서, <strong>로직은 가급적 수정하지 않는 것이 좋다</strong>는 것을 크게 느낄 수 있었기에 가급적 수정하지 않는 방향으로 구현하고 싶었다.</p>\n</li>\n</ol>\n<br/>\n코드는 다음과 같습니다.\n<br/>\n<p><U><strong>Controller</strong></U></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@PostMapping</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationResponse</span> <span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">ReservationRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ReservationTime</span> time <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReservationTime</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getTimeId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Reservation</span> reservation <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Reservation</span> created <span class=\"token operator\">=</span> reservationService<span class=\"token punctuation\">.</span><span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span>reservation<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReservationResponse</span><span class=\"token punctuation\">(</span>created<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p><U><strong>Service</strong></U></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReservationService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReservationDao</span> reservationDao<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReservationTimeDao</span> reservationTimeDao<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// 생성자..</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Reservation</span> <span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Reservation</span> reservation<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ReservationTime</span> reservationTime <span class=\"token operator\">=</span> reservationTimeDao<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token class-name\">Reservation</span> reservationForAdd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">(</span>\n                reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservation<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservationTime\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token keyword\">return</span> reservationDao<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>reservationForAdd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h3 id=\"문제점\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\" aria-label=\"문제점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제점</h3>\n<p>일단 구현 자체는 완료되었으나, <strong>불편함이 느껴지는 몇몇 문제</strong>가 있었습니다.</p>\n<br/>\n<p><U><strong>문제1. 컨트롤러에서 객체를 생성할 때 null 값을 입력하는 것</strong></U></p>\n<p>위의 컨트롤러 코드를 보면, <code class=\"language-text\">ReservationTime, Reservation</code>  객체를 생성할 때 null을 입력합니다. 보기 안 좋은 것도 있고, 전체 맥락을 모르는 사람이 이 코드를 보고 null값을 바로\nAUTO_INCREMENT 되는 ID로 생각할 수 있을까? 에 대한 의문이 들었습니다.</p>\n<p>하지만, 이 부분은 다음과 같이 <strong>생성자를 추가하여 해결</strong>할 수도 있기에 큰 문제라고 생각하진 않았습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReservationTime</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> startAt<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationTime</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> startAt<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> startAt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// 다른 생성자 및 Getter..</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p><U><strong>문제2. 객체를 여러번 생성해야 하고, getter의 호출이 많은 것</strong></U></p>\n<p>컨트롤러에서도 ReservationTime과 Reservation 객체를 생성하는데, <strong>서비스에서도 똑같이 생성합니다.</strong> 특히 시간 ID로 ReservationTime 객체를 조회할 때, <strong>그냥 ID로 한번에\n조회</strong>하면 되는 것을 <code class=\"language-text\">컨트롤러에서 ReservationTime 객체 생성 → 이 객체로 컨트롤러에서 Reservation 객체 생성 → Service에서 Reservation 객체에 Getter를 두 번 적용하여 시간 ID값을 꺼냄</code>\n이라는 불필요하게 복잡한 방법을 사용한다는 생각을 지울 수 없었습니다.</p>\n<br/>\n<p><U><strong>⭐️문제3. 컨트롤러가 도메인을 알고 있어야 한다.</strong></U></p>\n<p>문제1에서 느낀 것인데, 컨트롤러에서 null값을 넣는 것을 떠나서 <strong>ID 필드가 있다는 것을 알아야 하나?</strong> 라는 의문이 들었습니다. 컨트롤러에 도메인 객체가 있게 되면 실제 요청 / 응답에 사용되는 값 이외의\n다른 값들이 노출될 여지가 있다고 생각했습니다.</p>\n<br/>\n<h2 id=\"두-번째-시도\" style=\"position:relative;\"><a href=\"#%EB%91%90-%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\" aria-label=\"두 번째 시도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>두 번째 시도</h2>\n<h3 id=\"구현-방법-1\" style=\"position:relative;\"><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95-1\" aria-label=\"구현 방법 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>구현 방법</h3>\n<p>이전의 문제2,3이 생각보다 크게 느껴져서 이번에는 <strong>컨트롤러에서 DTO를 서비스로 그대로 전달하고, 서비스에서 도메인으로 변환하는</strong> 방법을 시도하였습니다. 응답할 때도 마찬가지로 <strong>서비스에서 도메인을 DTO로\n변환하여 컨트롤러에 전달</strong>하도록 수정하였습니다.</p>\n<br/>\n<p><U><strong>Controller</strong></U></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@PostMapping</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationResponse</span> <span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestBody</span> <span class=\"token class-name\">ReservationRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> reservationService<span class=\"token punctuation\">.</span><span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<p><U><strong>Service</strong></U></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationResponse</span> <span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReservationRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">ReservationTime</span> reservationTime <span class=\"token operator\">=</span> reservationTimeDao<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">timeId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Reservation</span> reservationForAdd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">(</span>\n            request<span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservationTime\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">Reservation</span> created <span class=\"token operator\">=</span> reservationDao<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>reservationForAdd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReservationResponse</span><span class=\"token punctuation\">(</span>created<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><strong>이전 문단의 문제1에서 언급한 해결책인 생성자 추가</strong>와 더불어 getter도 이천처럼 과하게 사용하지 않고, 코드가 훨씬 간결해졌습니다. 지금 단계에서는 DTO가 변경될 가능성도 크게 없고, 별도의 로직이라고\n할 법한 것도 없기에 간결하다는 장점이 명확한 이 방법을 최종적으로 사용하였습니다.</p>\n<br/>\n<h3 id=\"문제점-1\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90-1\" aria-label=\"문제점 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제점</h3>\n<p>코드가 간결해진다는 장점이 정말 크게 다가오기 때문에 이 방법을 사용하였으나, 예상되는 문제점이 없는 것은 아니었습니다.</p>\n<br/>\n<p><U><strong>문제1. DTO의 변화가 컨트롤러와 서비스 레이어에 모두 영향을 주게 된다.</strong></U></p>\n<p>같은 DTO를 사용하기에, 이 DTO의 변화가 두 레이어에 영향을 주게 되며, 추가적으로 <strong>요청이라는 View의 정보가 Service까지 영향을 미친다</strong>는 생각 역시 할 수 있습니다.</p>\n<p>가장 간단하게 떠오르는 해결 방법은 <strong>서비스용 DTO를 별도로 생성</strong>하고, 컨트롤러에서 변환한 뒤 넘기는 것인데 지금의 구조에선 <strong>두 DTO가 어차피 같은 값을 가져야 하기에</strong> 큰 의미가 없다는\n생각이었습니다.</p>\n<br/>\n<p><U><strong>문제2. (서비스에서 응답 DTO를 반환하는 경우) 서비스간에 의존한다면?</strong></U></p>\n<p>서비스에서 도메인이 아닌 DTO를 반환한다면 서비스간의 의존이 존재하는, 다음의 예시와 같은 문제가 발생할 수 있습니다.</p>\n<p><strong>예시</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReservationTimeService</span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationTimeResponse</span> <span class=\"token function\">findById</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> id<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>ReservationTimeService에서 findById()는 ReservationTimeResponse라는 DTO를 반환합니다.</li>\n</ul>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Service</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ReservationService</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReservationDao</span> reservationDao<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">ReservationTimeService</span> timeService<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ReservationResponse</span> <span class=\"token function\">addReservation</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ReservationRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token class-name\">ReservationTimeResponse</span> timeResponse <span class=\"token operator\">=</span> timeService<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">timeId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token comment\">// ReservationTimeResponse를 ReservationTime으로 변환하는 로직 필요</span>\n        <span class=\"token class-name\">ReservationTime</span> reservationTime <span class=\"token operator\">=</span> <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n        <span class=\"token class-name\">Reservation</span> reservationForAdd <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Reservation</span><span class=\"token punctuation\">(</span>\n                request<span class=\"token punctuation\">.</span><span class=\"token function\">name</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> reservationTime\n        <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n        <span class=\"token class-name\">Reservation</span> created <span class=\"token operator\">=</span> reservationDao<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>reservationForAdd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReservationResponse</span><span class=\"token punctuation\">(</span>created<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<p>예약을 추가하려면 Reservation 객체가 필요한데, 이 객체를 생성하려면 ReservationTime이 필요합니다.</p>\n</li>\n<li>\n<p>만약 ReservationTimeService에서 DTO를 반환하는 경우, 이 DTO를 도메인으로 변환하는 추가적인 연산이 필요해지게 됩니다.</p>\n</li>\n</ul>\n<p>하지만 <strong>지금의 구조에선 서비스간의 의존이 없고, 컨트롤러에 도메인 객체를 노출하는 것이 더 좋지 않은 방법으로 느껴졌기에</strong> 서비스에서 응답 DTO를 반환하는 지금의 구조를 유지하였습니다.</p>\n<br/>\n<h2 id=\"결론-및-요약\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0-%EB%B0%8F-%EC%9A%94%EC%95%BD\" aria-label=\"결론 및 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론 및 요약</h2>\n<p>이번 단계의 미션을 진행하며 했던 여러 시행착오와 고민 끝에 다음의 결론을 내렸습니다.</p>\n<ul>\n<li>\n<p>요청 시 컨트롤러에서 DTO를 도메인으로 변환하지 않는다.</p>\n<ul>\n<li>\n<p>컨트롤러에서 받는 요청값과 서비스에서 사용하는 값이 다른 경우 서비스 전용 DTO를 만든다.</p>\n</li>\n<li>\n<p>컨트롤러에서 받는 요청값을 서비스에서 그대로 사용한다면, 요청 DTO를 서비스로 그대로 전달한다.</p>\n</li>\n</ul>\n</li>\n<li>\n<p>서비스간의 의존이 없도록 구현하고, 서비스에서 응답 DTO를 반환하도록 구현한다.</p>\n</li>\n</ul>\n<p>지금 내린 결론이 당연히 정답은 아니기에 이후의 과정에서 방법이 변할 수도 있겠지만, 새로운 구현을 해야 할 때 고민하지 않고 바로 나아갈 방향을 정했고, 상황에 맞는 방법을 선택할 수 있게 되었다는 점에서\n정말 의미있는 경험을 했다고 생각합니다😄</p>\n<p>읽어주셔서 감사합니다! 즐거운 하루 보내세요🙇</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EB%B0%B0%EA%B2%BD\">배경</a></p>\n</li>\n<li>\n<p><a href=\"#%EA%B0%9C%EC%9A%94\">개요</a></p>\n<ul>\n<li><a href=\"#api%EC%9D%98-%EA%B5%AC%EC%84%B1\">API의 구성</a></li>\n<li><a href=\"#%EB%8F%84%EB%A9%94%EC%9D%B8\">도메인</a></li>\n<li><a href=\"#%EC%9A%94%EC%B2%AD-dto\">요청 DTO</a></li>\n<li><a href=\"#%EC%9D%91%EB%8B%B5-dto\">응답 DTO</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B2%AB-%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\">첫 번째 시도</a></p>\n<ul>\n<li><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95\">구현 방법</a></li>\n<li><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90\">문제점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%91%90-%EB%B2%88%EC%A7%B8-%EC%8B%9C%EB%8F%84\">두 번째 시도</a></p>\n<ul>\n<li><a href=\"#%EA%B5%AC%ED%98%84-%EB%B0%A9%EB%B2%95-1\">구현 방법</a></li>\n<li><a href=\"#%EB%AC%B8%EC%A0%9C%EC%A0%90-1\">문제점</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B2%B0%EB%A1%A0-%EB%B0%8F-%EC%9A%94%EC%95%BD\">결론 및 요약</a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 17, 2024","title":"Layered Architecture 적용 과정에서의 DTO 사용에 대한 고민","categories":"level2 Spring","author":"이상진","emoji":"🌱"},"fields":{"slug":"/woowacourse/level2/using_dto_in_layered_architecture/"}},"prev":{"id":"86b3f049-107b-5d8a-9b38-7b758c9d1dbb","html":"<h2 id=\"이전-편-내용-요약\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%A0%84-%ED%8E%B8-%EB%82%B4%EC%9A%A9-%EC%9A%94%EC%95%BD\" aria-label=\"이전 편 내용 요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>이전 편 내용 요약</h2>\n<ol>\n<li><code class=\"language-text\">@Valid</code> 어노테이션의 검증을 통해 발생하는 예외는 <code class=\"language-text\">MethodArgumentNotValidException</code> 입니다.</li>\n<li>테마, 시간 추가의 경우 값을 입력하지 않으면 빈 문자열(<code class=\"language-text\">””</code>)으로 JSON에 담겼기에 <code class=\"language-text\">@NotBlank</code> 를 통해 <code class=\"language-text\">MethodArgumentNotValidException</code> 이 발생했습니다.</li>\n<li>예약을 추가할 때는 회원, 날짜, 테마, 시간을 입력받습니다.</li>\n<li>날짜의 경우 입력하지 않으면 빈 문자열로 요청 JSON에 담기기에(<code class=\"language-text\">”date”: “”</code>) MethodArgumentNotValidException이 발생합니다.</li>\n<li>회원, 테마, 시간은 입력하지 않으면 각각 빈 문자열이 아닌 <code class=\"language-text\">“멤버 입력”, “테마 입력”, “시간 입력”</code> 으로 값이 담기고, 이 값을 Long 타입으로 파싱할 수 없습니다.\n<ul>\n<li>따라서 역직렬화 과정에서 InvalidFormatException이 발생하고, Jackson은 이 예외를 HttpMessageNotReadableException으로 던집니다.</li>\n</ul>\n</li>\n</ol>\n<p><strong>결론: 하나의 요청에서 다른 타입의 예외들이 발생하는데 이 예외를 한 번에 처리할 수가 없었습니다.</strong></p>\n<br/>\n<h2 id=\"custom-deserializer-시작\" style=\"position:relative;\"><a href=\"#custom-deserializer-%EC%8B%9C%EC%9E%91\" aria-label=\"custom deserializer 시작 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Custom Deserializer 시작</h2>\n<p>지금 현재의 문제를 크게 보면 <strong>역직렬화</strong> 과정에서 발생하는 문제이고, 이 문제를 해결하기 위해 Deserializer를 키워드로 구글링을 하던 도중, <a href=\"https://www.baeldung.com/jackson-deserialization\">Baeldung의 글</a>을 찾게 되었습니다.</p>\n<blockquote>\n<p>여담: 이번 레벨에서는 공식문서 다음으로 Baeldung을 가장 많이 참고하는 것 같습니다 ㅎㅎ</p>\n</blockquote>\n<p>우선, 지난 글에 작성했지만 역직렬화가 필요한 요청 DTO 코드를 다시 한번 작성하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">AdminReservationCreateRequest</span><span class=\"token punctuation\">(</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"날짜를 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">LocalDate</span> date<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"시간을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> timeId<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"테마를 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> themeId<span class=\"token punctuation\">,</span>\n        <span class=\"token annotation punctuation\">@NotNull</span><span class=\"token punctuation\">(</span>message <span class=\"token operator\">=</span> <span class=\"token string\">\"회원을 입력해 주세요.\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> memberId\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Postman을 이용하여 확인해보니, <strong>@NotNull</strong> 어노테이션은 <strong>JSON에 해당 필드 자체가 없는 상황</strong>에서 예외를 던지고 있었습니다. 하지만 페이지에서 직접 예약을 추가할 땐, 필드 자체가 없는 상황이 없으므로.. 지금 상황에서는 크게 의미가 있진 않았습니다.</p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AdminReservationCreateRequestDeserializer</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">StdDeserailizer</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">AdminReservationCreateRequest</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token comment\">// 생성자는 Baeldung에 있는 것과 동일하게 작성</span>\n\t\n\t<span class=\"token annotation punctuation\">@Override</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">AdminReservationCreateRequest</span> <span class=\"token function\">deserialize</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonParser</span> jsonParser<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DeserializationContext</span> deserializationContext<span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">JacksonException</span> <span class=\"token punctuation\">{</span>\n            \n     <span class=\"token class-name\">JsonNode</span> jsonNode <span class=\"token operator\">=</span> jsonParser<span class=\"token punctuation\">.</span><span class=\"token function\">getCodec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readTree</span><span class=\"token punctuation\">(</span>jsonParser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n     <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드를 보니, 일단 JsonNode라는 객체를 먼저 꺼내옵니다. 어찌됐든 이 객체를 활용하는 것이기에, <code class=\"language-text\">getCodec().readTree()</code>  부분은 그냥 이렇게 불러오는구나 ~ 하고 넘어갔습니다. 자연스레 다음 의문은 JsonNode가 무엇인지로 이어집니다.</p>\n<p>사실 이번 문제는 getter를 그냥 느낌대로 쓰다보니 어느정도 해결이 되었는데요, Custom Deserializer는 추후에도 충분히 사용할 수 있다고 생각되어 이번 기회에 JsonNode도 이해하면 좋겠다고 생각했습니다.</p>\n<br/>\n<h2 id=\"jsonnode가-뭔가요\" style=\"position:relative;\"><a href=\"#jsonnode%EA%B0%80-%EB%AD%94%EA%B0%80%EC%9A%94\" aria-label=\"jsonnode가 뭔가요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JsonNode가 뭔가요?</h2>\n<h3 id=\"공식-문서\" style=\"position:relative;\"><a href=\"#%EA%B3%B5%EC%8B%9D-%EB%AC%B8%EC%84%9C\" aria-label=\"공식 문서 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>공식 문서</h3>\n<p><a href=\"https://www.javadoc.io/doc/com.fasterxml.jackson.core/jackson-databind/2.8.5/com/fasterxml/jackson/databind/JsonNode.html\">공식 문서</a>를 보면, 다음과 같이 적혀있습니다.</p>\n<blockquote>\n<p>Base class for all JSON nodes, which form the basis of JSON Tree Model that Jackson implements. One way to think of these nodes is to consider them similar to DOM nodes in XML DOM trees.</p>\n<p>As a general design rule, most accessors (“getters”) are included in this base class, to allow for traversing structure without type casts. Most mutators, however, need to be accessed through specific sub-classes (such as <code class=\"language-text\">ObjectNode</code> and <code class=\"language-text\">ArrayNode</code>). This seems sensible because proper type information is generally available when building or modifying trees, but less often when reading a tree (newly built from parsed JSON content).</p>\n<p>Actual concrete sub-classes can be found from package <a href=\"https://www.javadoc.io/static/com.fasterxml.jackson.core/jackson-databind/2.8.5/com/fasterxml/jackson/databind/node/package-summary.html\"><code class=\"language-text\">com.fasterxml.jackson.databind.node</code></a>.</p>\n<p>Note that it is possible to “read” from nodes, using method <a href=\"https://fasterxml.github.com/jackson-core/javadoc/2.7/com/fasterxml/jackson/core/TreeNode.html?is-external=true#traverse(com.fasterxml.jackson.core.ObjectCodec)\"><code class=\"language-text\">TreeNode.traverse(ObjectCodec)</code></a>, which will result in a <a href=\"https://fasterxml.github.com/jackson-core/javadoc/2.7/com/fasterxml/jackson/core/JsonParser.html?is-external=true\"><code class=\"language-text\">JsonParser</code></a> being constructed. This can be used for (relatively) efficient conversations between different representations; and it is what core databind uses for methods like <a href=\"https://www.javadoc.io/static/com.fasterxml.jackson.core/jackson-databind/2.8.5/com/fasterxml/jackson/databind/ObjectMapper.html#treeToValue(com.fasterxml.jackson.core.TreeNode,%20java.lang.Class)\"><code class=\"language-text\">ObjectMapper.treeToValue(TreeNode, Class)</code></a> and <a href=\"https://www.javadoc.io/static/com.fasterxml.jackson.core/jackson-databind/2.8.5/com/fasterxml/jackson/databind/ObjectMapper.html#treeAsTokens(com.fasterxml.jackson.core.TreeNode)\"><code class=\"language-text\">ObjectMapper.treeAsTokens(TreeNode)</code></a></p>\n</blockquote>\n<p>사실 처음 읽었을 땐, <strong>음.. 그렇구나..</strong> 라는 생각만 들더라구요. 이 문서에선 그냥 <code class=\"language-text\">JSON 값들을 트리 형태로 구성하는 거구나. getter를 통해 값을 꺼낼 수 있구나</code> 정도만 일단 파악하는게 합리적이라고 생각했습니다.</p>\n<br/>\n<h3 id=\"jsonnode-구성\" style=\"position:relative;\"><a href=\"#jsonnode-%EA%B5%AC%EC%84%B1\" aria-label=\"jsonnode 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JsonNode 구성</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">com<span class=\"token punctuation\">.</span>fasterxml<span class=\"token punctuation\">.</span>jackson<span class=\"token punctuation\">.</span>databind</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">JsonNode</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">JsonSerializable<span class=\"token punctuation\">.</span>Base</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">TreeNode</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Iterable</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">JsonNode</span><span class=\"token punctuation\">></span></span> <span class=\"token punctuation\">{</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>소스코드를 확인해보니, 우선 기본적으로 JsonNode는 <code class=\"language-text\">TreeNode</code> 인터페이스를 구현하고 있고, 그 아래에 JsonNode를 상속받는 클래스들이 존재했습니다. 상속받는 클래스들은 <code class=\"language-text\">com.fasterxml.jackson.databind.node</code> 패키지에 존재했는데요, <strong>Intellij의 다이어그램 기능</strong>을 활용해 보겠습니다.</p>\n<br/>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABYlAAAWJQFJUiTwAAACCElEQVQ4y21T2XbrIBDLhzQ2+2KD8YaXJG1P//+jdC+TpUnbB53gDGiQRhwYV/gNCS40ujHjdPmE9y1qJl7q9zW/4f59uBZ/QhFBxRRqrlFV/InoBiZR1QLHiuNYMVrfCF87EpiEUBahG5CGCU0bUbPXPUVBGyNSP2IYZ9pTzh1+db4TSoNuXDAtO9rQPRHK220kfBuQ1xXLtiOERHv+IPyWfKwFqiKZKQjlwKWF0B7WR1jbwFgPofRV8s2WvyXfhqJtA209pDKPm0vlMEwL1vMHtv2EEDuqC6np3OF1cleU2xXJ87Lj/fOLfKpq/hhGXSRLh5BmLOuO/XQhW4oVh+cbcWnApKHfAmEaCNOCCQOuLNVoXeplv3Jg0oIJ/VBJhHXNUQtDHffLB8Z5JaJ+2iiHTRygXETeL9jP7zAuQLuAdT9j2c7U7MXDJiTk9YS8bGR2GmYs2wld6qG1Qz9mkmZdA+NaTHnDnFeqtbFHXnZ0afj2UGmHOGRY11JQyzRLrpS2eDtyaOPhm0A+1kzB+UCob3n1TaSzD8KqjF1Y+G7CtJ7RDRlMOZh2wJh3KBtgmoQxbzA+4O3IKCrXeElq9PRSJJTxiGnCvGzoh/kqoZ9I+jhl9NOCkZDpvzYmkvvz9RBhiUgxuWwOMVGYi6fTvFAUuDDkYex6MK4R00j+FT/vL6ZEifBf8j9TvZdRgmQnIgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"jsonnode_diagram.png\"\n        title=\"jsonnode_diagram.png\"\n        src=\"/static/03b901d157e2475d959d9a970307ce96/37523/jsonnode_diagram.png\"\n        srcset=\"/static/03b901d157e2475d959d9a970307ce96/e9ff0/jsonnode_diagram.png 180w,\n/static/03b901d157e2475d959d9a970307ce96/f21e7/jsonnode_diagram.png 360w,\n/static/03b901d157e2475d959d9a970307ce96/37523/jsonnode_diagram.png 720w,\n/static/03b901d157e2475d959d9a970307ce96/302a4/jsonnode_diagram.png 1080w,\n/static/03b901d157e2475d959d9a970307ce96/07a9c/jsonnode_diagram.png 1440w,\n/static/03b901d157e2475d959d9a970307ce96/49b61/jsonnode_diagram.png 1756w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<p>이 다이어그램을 보고, 저는 아래의 세 가지를 생각(추측)할 수 있었습니다.</p>\n<ol>\n<li>JsonNode는 ValueNode와 ContainerNode로 구분할 수 있다.</li>\n<li>ValueNode 하위의 노드들과 ContainerNode 하위의 노드들을 보니, ValueNode는 값을 저장하는 노드이고 ContainerNode는 Json 자체 혹은 하위의 배열을 저장하는 노드일 것이라고 추측할 수 있다.</li>\n<li>그러면, <code class=\"language-text\">JsonNode jsonNode = jsonParser.getCodec().readTree(jsonParser);</code> 를 이용하여 꺼낸 노드는 <strong>ContainerNode</strong>일 것이고, 여기서 getter를 사용하면 ValueNode를 얻어낼 수 있을 것 같다.</li>\n</ol>\n<p>이 추측을 바탕으로 실제로 확인 해 보기 전에, JsonNode의 소스 코드를 보며 Type에 대해 조금 더 알아보겠습니다.</p>\n<br/>\n<h3 id=\"jsonnode의-타입\" style=\"position:relative;\"><a href=\"#jsonnode%EC%9D%98-%ED%83%80%EC%9E%85\" aria-label=\"jsonnode의 타입 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JsonNode의 타입</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">enum</span> <span class=\"token class-name\">JsonNodeType</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token constant\">ARRAY</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">BINARY</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">BOOLEAN</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">MISSING</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">NULL</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">NUMBER</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">OBJECT</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">POJO</span><span class=\"token punctuation\">,</span>\n    <span class=\"token constant\">STRING</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">JsonNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>JsonNode는, 위의 Enum을 통해 타입을 분류하고 있습니다. 이름만으로도 어느정도 유추가 가능하네요.</p>\n<br/>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isValueNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">case</span> <span class=\"token constant\">ARRAY</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">case</span> <span class=\"token constant\">OBJECT</span><span class=\"token operator\">:</span>\n        <span class=\"token keyword\">case</span> <span class=\"token constant\">MISSING</span><span class=\"token operator\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">default</span><span class=\"token operator\">:</span>\n            <span class=\"token keyword\">return</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">isContainerNode</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">JsonNodeType</span> type <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> type <span class=\"token operator\">==</span> <span class=\"token class-name\">JsonNodeType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">OBJECT</span> <span class=\"token operator\">||</span> type <span class=\"token operator\">==</span> <span class=\"token class-name\">JsonNodeType</span><span class=\"token punctuation\">.</span><span class=\"token constant\">ARRAY</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">JsonNodeType</span> <span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>위의 <code class=\"language-text\">JsonNodeType</code> enum과 이 JsonNode의 코드를 보면, 타입은 다음과 같이 구분할 수 있겠네요.</p>\n<ol>\n<li><code class=\"language-text\">ARRAY, OBJECT</code>는 <code class=\"language-text\">ContainerNode</code>이다.</li>\n<li><code class=\"language-text\">MISSING</code>은 <code class=\"language-text\">ValueNode도, ContainerNode도 아니다.</code></li>\n<li><code class=\"language-text\">나머지는 ValueNode</code>이다.</li>\n</ol>\n<br/>\n<h3 id=\"get-vs-path와-missingnode\" style=\"position:relative;\"><a href=\"#get-vs-path%EC%99%80-missingnode\" aria-label=\"get vs path와 missingnode permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>get() vs path()와 MissingNode</h3>\n<p>실제로 노드를 꺼내서 확인해보기 전에, <code class=\"language-text\">get()</code>과 <code class=\"language-text\">path()</code>, 그리고 <code class=\"language-text\">MissingNode</code>에 대해 한번 더 언급하고 가겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">JsonNode</span> rootNode <span class=\"token operator\">=</span> jsonParser<span class=\"token punctuation\">.</span><span class=\"token function\">getCodec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readTree</span><span class=\"token punctuation\">(</span>jsonParser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token class-name\">JsonNode</span> jsonNode1 <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsonNode\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token class-name\">JsonNode</span> jsonNode2 <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"jsonNode\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>(미리 스포하자면 rootNode는 JsonNode를 상속받는 ObjectNode 타입입니다.)</strong> 위 코드만 보면, get과 path는 크게 달라보이지 않습니다. 그러면 어떤 것을 사용해야 할까요?</p>\n<br/>\n<p>JsonNode를 상속받는 ObjectNode의 소스코드를 확인해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ObjectNode</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ContainerNode</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ObjectNode</span><span class=\"token punctuation\">></span></span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">Serializable</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">protected</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">JsonNode</span><span class=\"token punctuation\">></span></span> _children<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\t\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">JsonNode</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> propertyName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonNode</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_children<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>propertyName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\t\n\t<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\t\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">JsonNode</span> <span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> propertyName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">JsonNode</span> n <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonNode</span><span class=\"token punctuation\">)</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_children<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>propertyName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonNode</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> n <span class=\"token operator\">:</span> <span class=\"token class-name\">MissingNode</span><span class=\"token punctuation\">.</span><span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 코드를 보면, <strong>get은 Json에 필드가 없으면 null을, path는 MissingNode 타입 객체를 반환</strong>하는 것을 알 수 있습니다. <strong>저는 앞으로 NPE 방지를 위해 path()를 사용하겠습니다!</strong></p>\n<br/>\n<h3 id=\"-타입을-직접-확인해-보겠습니다\" style=\"position:relative;\"><a href=\"#-%ED%83%80%EC%9E%85%EC%9D%84-%EC%A7%81%EC%A0%91-%ED%99%95%EC%9D%B8%ED%95%B4-%EB%B3%B4%EA%B2%A0%EC%8A%B5%EB%8B%88%EB%8B%A4\" aria-label=\" 타입을 직접 확인해 보겠습니다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🚀 타입을 직접 확인해 보겠습니다.</h3>\n<p>우선, 다음과 같은 JSON과 여기에 대응되는 DTO 객체를 만들어 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"number\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"string\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"null\"</span><span class=\"token operator\">:</span> <span class=\"token null keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"boolean\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"objectList\"</span> <span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"obj1\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"obj2\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"text\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@JsonDeserialize</span><span class=\"token punctuation\">(</span>using <span class=\"token operator\">=</span> <span class=\"token class-name\">JsonTestRequestDeserializer</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">class</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">record</span> <span class=\"token class-name\">JsonTestRequest</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Long</span> number<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> string<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span> nullObject<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Boolean</span> booleanObject<span class=\"token punctuation\">,</span>\n                              <span class=\"token class-name\">List</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> objectList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>(미리 스포할 수 밖에 없네요 ㅠㅠ) 마지막에 다룰 Custom Deserializer는 해당되는 객체에 <code class=\"language-text\">@JsonDeserialize</code>를 붙여 적용할 수 있습니다 ㅎㅎ</p>\n<br/>\n<p>마지막으로, Custom Deserializer를 대략적으로 만들어 보겠습니다! (메서드만 작성하겠습니다)</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Override</span>\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">JsonTestRequest</span> <span class=\"token function\">deserialize</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">JsonParser</span> jsonParser<span class=\"token punctuation\">,</span> <span class=\"token class-name\">DeserializationContext</span> deserializationContext<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">JacksonException</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token class-name\">JsonNode</span> rootNode <span class=\"token operator\">=</span> jsonParser<span class=\"token punctuation\">.</span><span class=\"token function\">getCodec</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">readTree</span><span class=\"token punctuation\">(</span>jsonParser<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">JsonNode</span> numberNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JsonNode</span> stringNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JsonNode</span> nullNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JsonNode</span> booleanNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"boolean\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JsonNode</span> objectListNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"objectList\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">JsonNode</span> missingNode <span class=\"token operator\">=</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">path</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"missing\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"rootNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"numberNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> numberNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"stringNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> stringNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"nullNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> nullNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"booleanNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> booleanNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"objectListNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> objectListNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"missingNode.getNodeType() = \"</span> <span class=\"token operator\">+</span> missingNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JsonTestRequest</span><span class=\"token punctuation\">(</span>\n            rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"number\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"string\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"null\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"boolean\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asBoolean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n            <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">asList</span><span class=\"token punctuation\">(</span>objectListNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"obj1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> objectListNode<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"obj2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">asText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이전 문단에서 언급했던 것 처럼, <code class=\"language-text\">MissingNode</code>를 체크하기 위해 get()이 아닌 <code class=\"language-text\">path()</code>를 사용했고 이렇게 얻어낸 노드들의 타입을 출력한 뒤 DTO로 매핑하고 있습니다. <code class=\"language-text\">asLong(), asText()</code> 와 같은 것은 이후에 작성하겠습니다.</p>\n<br/>\n<p>실제로 코드를 실행해보면 다음과 같은 결과가 나오구요,</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\">rootNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">OBJECT</span>\nnumberNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">NUMBER</span>\nstringNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">STRING</span>\nnullNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">NULL</span>\nbooleanNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">BOOLEAN</span>\nobjectListNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">OBJECT</span>\nmissingNode<span class=\"token punctuation\">.</span><span class=\"token function\">getNodeType</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token constant\">MISSING</span></code></pre></div>\n<p>출력 결과를 정리해보면</p>\n<ol>\n<li>전체 JSON인 rootNode와, JSON 내부의 배열인 objectListNode는 ObjectNode가 됩니다.\n<ul>\n<li><strong>이 노드들은 내부에 여러 값을 가지고 있기에, ContainerNode에 해당됩니다.</strong></li>\n</ul>\n</li>\n<li>나머지 노드들은, 각각 <strong>값을 가지고 있는 ValueNode</strong>에 속합니다.</li>\n<li>위의 Json에 <code class=\"language-text\">“missing”</code> 필드는 없기 때문에, missingNode는 MissingNode 타입이 됩니다.</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">JsonTestRequest</span><span class=\"token punctuation\">[</span>number<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> string<span class=\"token operator\">=</span>text<span class=\"token punctuation\">,</span> nullObject<span class=\"token operator\">=</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> booleanObject<span class=\"token operator\">=</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> objectList<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"text\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>마지막으로, 만들어진 <code class=\"language-text\">JsonTestRequset</code>  객체를 출력해보면, 값이 잘 들어간 것을 확인할 수 있습니다 ㅎㅎ</p>\n<br/>\n<h2 id=\"jsonnode에서-값-꺼내기\" style=\"position:relative;\"><a href=\"#jsonnode%EC%97%90%EC%84%9C-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\" aria-label=\"jsonnode에서 값 꺼내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JsonNode에서 값 꺼내기</h2>\n<p>JsonNode에서 get(), path() 등을 하다 보면, 값을 가지고 있는 ValueNode를 얻어낼 수 있습니다.</p>\n<blockquote>\n<p>만약 ContainerNode라면 get(), path()를 또 적용해서 ValueNode를 얻어내야 합니다 ㅎㅎ</p>\n</blockquote>\n<p>그러면, ValueNode에서의 값은 어떻게 꺼낼 수 있을까요? 값은 <code class=\"language-text\">숫자, 불리언, 문자열 타입</code>으로 가져올 수 있습니다. 기본값을 지정할 수도 있지만, <strong>이번에는 기본값을 지정하지 않는 경우를 위주로 확인</strong> 하겠습니다.</p>\n<h3 id=\"1-숫자-값-꺼내기\" style=\"position:relative;\"><a href=\"#1-%EC%88%AB%EC%9E%90-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\" aria-label=\"1 숫자 값 꺼내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 숫자 값 꺼내기</h3>\n<p>종류로는 <code class=\"language-text\">asLong(), asInt(), asDouble()</code>이 있고, 예시에서는 Long을 기준으로 작성하겠습니다.</p>\n<p>우선, JsonNode에 있는 <code class=\"language-text\">asLong()</code> 메서드를 먼저 확인해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token number\">0L</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> defaultValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> defaultValue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>코드를 보니, <code class=\"language-text\">asLong()</code>을 호출하면 기본값을 0으로 지정하고 <code class=\"language-text\">asLong(long defaultValue)</code>을 호출하는데, 이 메서드는 하위 클래스에서 Override 하고 있습니다. 하위 클래스 중 <code class=\"language-text\">NumericNode</code> 는 값을 그대로 반환하기에, <code class=\"language-text\">BooleanNode</code>와 <code class=\"language-text\">TextNode</code> 만 예시로 작성하겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">BooleanNode</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ValueNode</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">boolean</span> _value<span class=\"token punctuation\">;</span>\n\t\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> defaultValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_value <span class=\"token operator\">?</span> <span class=\"token number\">1L</span> <span class=\"token operator\">:</span> <span class=\"token number\">0L</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\t\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>BooleanNode에서는 값이 <code class=\"language-text\">true</code>이면 1을, <code class=\"language-text\">false</code> 이면 0을 반환합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">TextNode</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">ValueNode</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">protected</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> _value<span class=\"token punctuation\">;</span>\n\t    \n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">long</span> <span class=\"token function\">asLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">long</span> defaultValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token class-name\">NumberInput</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseAsLong</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_value<span class=\"token punctuation\">,</span> defaultValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">final</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">NumberInput</span> <span class=\"token punctuation\">{</span>\n\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">long</span> <span class=\"token function\">parseAsLong</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> s<span class=\"token punctuation\">,</span> <span class=\"token keyword\">long</span> def<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>s <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> def<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n\t    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> <span class=\"token class-name\">Long</span><span class=\"token punctuation\">.</span><span class=\"token function\">parseLong</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">NumberFormatException</span> var9<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">return</span> def<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>TextNode에선, 값을 Long으로 파싱한 뒤 반환하는데, 이때 사용하는 <code class=\"language-text\">NumberInput.parseAsLong</code> 을 보면, 입력된 값이 null이거나 숫자로 변환할 수 없으면 기본값을 반환합니다. <strong>기본값은 JsonNode에서 0으로 지정했으니, 숫자가 아니거나 null인 경우는 0이 반환되겠네요!</strong></p>\n<h3 id=\"2-문자열-값-꺼내기\" style=\"position:relative;\"><a href=\"#2-%EB%AC%B8%EC%9E%90%EC%97%B4-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\" aria-label=\"2 문자열 값 꺼내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 문자열 값 꺼내기</h3>\n<p>마찬가지로, 우선 JsonNode의 코드를 확인해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">abstract</span> <span class=\"token class-name\">String</span> <span class=\"token function\">asText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">asText</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> defaultValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token class-name\">String</span> str <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">asText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> str <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">?</span> defaultValue <span class=\"token operator\">:</span> str<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">asText()</code> 메서드를 이용하여 문자열 값을 꺼내올 수 있고, 이 메서드는 하위 클래스에서 구현하고 있네요. 이전의 숫자 값을 꺼낼때를 생각해보면, 숫자 노드에서는 값을 그대로 꺼내왔고 문자 노드에서는 숫자로 파싱한 뒤 꺼내왔습니다. <code class=\"language-text\">그러면 이번에도 문자열 값은 그대로 꺼내고 숫자 값은 문자로 파싱한뒤 꺼낸다.</code> 정도는 예상할 수 있겠네요 ㅎㅎ</p>\n<p>이번에는 소스코드 작성 없이, 결과만 요약하여 정리하겠습니다</p>\n<table>\n<thead>\n<tr>\n<th>타입</th>\n<th>반환값</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>NumericNode</td>\n<td>숫자를 문자열로 변환하여 반환</td>\n</tr>\n<tr>\n<td>BooleanNode</td>\n<td>true는 “true”, false는 “false”로 반환</td>\n</tr>\n<tr>\n<td>MissingNode</td>\n<td>“” 즉 빈 문자열</td>\n</tr>\n<tr>\n<td>NullNode</td>\n<td>“null”</td>\n</tr>\n<tr>\n<td>TextNode</td>\n<td>값 그대로 반환</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"3-불리언-값-꺼내기\" style=\"position:relative;\"><a href=\"#3-%EB%B6%88%EB%A6%AC%EC%96%B8-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\" aria-label=\"3 불리언 값 꺼내기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 불리언 값 꺼내기</h3>\n<p>JsonNode에 있는 코드를 먼저 확인해 보겠습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">asBoolean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">asBoolean</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">boolean</span> <span class=\"token function\">asBoolean</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">boolean</span> defaultValue<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> defaultValue<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">asBoolean()</code> 을 호출하면, <code class=\"language-text\">asLong()</code>과 마찬가지로 기본값으로 false를 넣어 <code class=\"language-text\">asBoolean(boolean defaultValue)</code> 를 호출하고, 이 메서드는 하위 클래스에서 Override 하고 있습니다. 지금까지의 결과를 보면, 혹은 느낌상으로 다음과 같이 예상할 수 있을 것 같네요.</p>\n<ol>\n<li>TextNode의 경우 <code class=\"language-text\">“true” “false”이면 불리언 타입으로 변환하여 반환</code>한다. 둘다 아니면 기본값인 false를 반환한다.</li>\n<li>NumericNode의 경우 <code class=\"language-text\">0이 아니면 true, 0이면 false</code>를 반환한다.</li>\n<li>BooleanNode는 값을 그대로 반환한다.</li>\n</ol>\n<p>이렇게 예상했다면, 정답입니다👍👍</p>\n<h2 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h2>\n<h3 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h3>\n<ol>\n<li>JsonNode는 컨테이너 노드와 값 노드로 구성되어 있다. Json 자체와 Json 내부 배열은 컨테이너 노드, 각각의 필드는 값 노드가 된다.\n<ul>\n<li>컨테이너 노드는 ObjectNode, ArrayNode를 하위 클래스로 가진다.</li>\n<li>값 노드는 Text, Numeric(Long, Int..), Boolean을 하위 클래스로 가진다.</li>\n</ul>\n</li>\n<li><code class=\"language-text\">get(String propertyName), path(String propertyName)</code> 를 이용하여 하위 노드를 꺼낼 수 있다.</li>\n<li>get은 노드가 존재하지 않으면 null을, path는 MissingNode 객체를 반환하는데 NPE 방지를 위해서 <code class=\"language-text\">path()</code> 를 쓰는 것이 좋을 것 같다.</li>\n<li>get(), path()를 사용하여 값 노드(ValueNode)를 꺼냈다면, <code class=\"language-text\">asLong(), asText(), asBoolean()</code> 을 이용해 실제 값을 꺼낼 수 있다.</li>\n</ol>\n<h3 id=\"다음-편에서-계속됩니다\" style=\"position:relative;\"><a href=\"#%EB%8B%A4%EC%9D%8C-%ED%8E%B8%EC%97%90%EC%84%9C-%EA%B3%84%EC%86%8D%EB%90%A9%EB%8B%88%EB%8B%A4\" aria-label=\"다음 편에서 계속됩니다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>다음 편에서 계속됩니다..</h3>\n<p>JsonNode와 소스코드에 대해 최대한 간단하게 작성했다고 생각했는데, 생각보다 내용이 너무 길어 한번 더 끊고 가야할 것 같네요..😓 다음 편에서는 학습한 JsonNode를 바탕으로 1편의 문제를 Custom Deserializer를 이용하여 해결해 보도록 하겠습니다.</p>\n<p>읽어주셔서 감사합니다. 즐거운 하루 보내세요😄</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%EC%9D%B4%EC%A0%84-%ED%8E%B8-%EB%82%B4%EC%9A%A9-%EC%9A%94%EC%95%BD\">이전 편 내용 요약</a></p>\n</li>\n<li>\n<p><a href=\"#custom-deserializer-%EC%8B%9C%EC%9E%91\">Custom Deserializer 시작</a></p>\n</li>\n<li>\n<p><a href=\"#jsonnode%EA%B0%80-%EB%AD%94%EA%B0%80%EC%9A%94\">JsonNode가 뭔가요?</a></p>\n<ul>\n<li><a href=\"#%EA%B3%B5%EC%8B%9D-%EB%AC%B8%EC%84%9C\">공식 문서</a></li>\n<li><a href=\"#jsonnode-%EA%B5%AC%EC%84%B1\">JsonNode 구성</a></li>\n<li><a href=\"#jsonnode%EC%9D%98-%ED%83%80%EC%9E%85\">JsonNode의 타입</a></li>\n<li><a href=\"#get-vs-path%EC%99%80-missingnode\">get() vs path()와 MissingNode</a></li>\n<li><a href=\"#-%ED%83%80%EC%9E%85%EC%9D%84-%EC%A7%81%EC%A0%91-%ED%99%95%EC%9D%B8%ED%95%B4-%EB%B3%B4%EA%B2%A0%EC%8A%B5%EB%8B%88%EB%8B%A4\">🚀 타입을 직접 확인해 보겠습니다.</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#jsonnode%EC%97%90%EC%84%9C-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\">JsonNode에서 값 꺼내기</a></p>\n<ul>\n<li><a href=\"#1-%EC%88%AB%EC%9E%90-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\">1. 숫자 값 꺼내기</a></li>\n<li><a href=\"#2-%EB%AC%B8%EC%9E%90%EC%97%B4-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\">2. 문자열 값 꺼내기</a></li>\n<li><a href=\"#3-%EB%B6%88%EB%A6%AC%EC%96%B8-%EA%B0%92-%EA%BA%BC%EB%82%B4%EA%B8%B0\">3. 불리언 값 꺼내기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EA%B2%B0%EB%A1%A0\">결론</a></p>\n<ul>\n<li><a href=\"#%EC%9A%94%EC%95%BD\">요약</a></li>\n<li><a href=\"#%EB%8B%A4%EC%9D%8C-%ED%8E%B8%EC%97%90%EC%84%9C-%EA%B3%84%EC%86%8D%EB%90%A9%EB%8B%88%EB%8B%A4\">다음 편에서 계속됩니다..</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"June 19, 2024","title":"스프링 입력에서의 예외 처리 여정 2 - JsonNode","categories":"level2 Spring Exception","author":"이상진","emoji":"🌱"},"fields":{"slug":"/woowacourse/level2/spring_validation_in_request/2/"}},"site":{"siteMetadata":{"siteUrl":"https://pricelees.github.io","comments":{"utterances":{"repo":"pricelees/pricelees.github.io"}}}}},"pageContext":{"slug":"/woowacourse/level2/spring_validation_in_request/1/","nextSlug":"/woowacourse/level2/using_dto_in_layered_architecture/","prevSlug":"/woowacourse/level2/spring_validation_in_request/2/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}